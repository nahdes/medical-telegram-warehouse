{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-18T08:42:28.537340Z", "invocation_id": "cc992946-1097-4671-8ada-fca832d40d24", "invocation_started_at": "2026-01-18T08:42:26.042488Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T08:42:27.990804Z", "completed_at": "2026-01-18T08:42:27.998569Z"}, {"name": "execute", "started_at": "2026-01-18T08:42:27.999093Z", "completed_at": "2026-01-18T08:42:28.160380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17139172554016113, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "/*\n    Staging model for Telegram messages\n    Cleans and standardizes raw telegram data\n*/\n\nWITH source AS (\n    SELECT * FROM \"medical_warehouse\".\"raw\".\"telegram_messages\"\n),\n\ncleaned AS (\n    SELECT\n        -- Primary identifiers\n        message_id,\n        channel_name,\n        \n        -- Dates and timestamps\n        message_date::TIMESTAMP AS message_timestamp,\n        message_date::DATE AS message_date,\n        scraped_at::TIMESTAMP AS scraped_at,\n        \n        -- Message content\n        TRIM(message_text) AS message_text,\n        LENGTH(TRIM(message_text)) AS message_length,\n        \n        -- Media flags\n        COALESCE(has_media, FALSE) AS has_media,\n        CASE \n            WHEN has_media AND image_path IS NOT NULL THEN TRUE\n            ELSE FALSE\n        END AS has_image,\n        image_path,\n        \n        -- Engagement metrics\n        COALESCE(views, 0) AS view_count,\n        COALESCE(forwards, 0) AS forward_count,\n        \n        -- Reply information\n        COALESCE(is_reply, FALSE) AS is_reply,\n        reply_to_msg_id,\n        \n        -- Metadata\n        source_file,\n        \n        -- Calculated fields\n        CASE\n            WHEN LENGTH(TRIM(message_text)) = 0 THEN TRUE\n            ELSE FALSE\n        END AS is_empty_message,\n        \n        -- Extract time components\n        EXTRACT(HOUR FROM message_date) AS message_hour,\n        EXTRACT(DOW FROM message_date) AS day_of_week,\n        \n        -- Derive channel type based on channel name\n        CASE\n            WHEN LOWER(channel_name) LIKE '%pharm%' THEN 'Pharmaceutical'\n            WHEN LOWER(channel_name) LIKE '%cosmet%' THEN 'Cosmetics'\n            WHEN LOWER(channel_name) LIKE '%med%' THEN 'Medical'\n            ELSE 'Other'\n        END AS channel_type\n\n    FROM source\n    \n    -- Data quality filters\n    WHERE \n        message_id IS NOT NULL\n        AND channel_name IS NOT NULL\n        AND message_date IS NOT NULL\n        AND message_date <= CURRENT_TIMESTAMP  -- No future dates\n)\n\nSELECT * FROM cleaned", "relation_name": "\"medical_warehouse\".\"public_staging\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T08:42:28.172103Z", "completed_at": "2026-01-18T08:42:28.218213Z"}, {"name": "execute", "started_at": "2026-01-18T08:42:28.219080Z", "completed_at": "2026-01-18T08:42:28.342736Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17360496520996094, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "/*\n    Dimension: Channels\n    Contains information about each Telegram channel\n*/\n\nWITH channel_metrics AS (\n    SELECT\n        channel_name,\n        channel_type,\n        MIN(message_date) AS first_post_date,\n        MAX(message_date) AS last_post_date,\n        COUNT(*) AS total_posts,\n        COUNT(CASE WHEN has_image THEN 1 END) AS total_posts_with_images,\n        AVG(view_count) AS avg_views,\n        AVG(forward_count) AS avg_forwards,\n        MAX(view_count) AS max_views,\n        SUM(view_count) AS total_views,\n        SUM(forward_count) AS total_forwards,\n        AVG(message_length) AS avg_message_length,\n        \n        -- Engagement rate (posts with > 0 views)\n        COUNT(CASE WHEN view_count > 0 THEN 1 END)::FLOAT / \n            NULLIF(COUNT(*), 0) AS engagement_rate,\n        \n        -- Image content ratio\n        COUNT(CASE WHEN has_image THEN 1 END)::FLOAT / \n            NULLIF(COUNT(*), 0) AS image_content_ratio\n\n    FROM \"medical_warehouse\".\"public_staging\".\"stg_telegram_messages\"\n    GROUP BY channel_name, channel_type\n)\n\nSELECT\n    -- Surrogate key\n    md5(cast(coalesce(cast(channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS channel_key,\n    \n    -- Natural key and attributes\n    channel_name,\n    channel_type,\n    \n    -- Time metrics\n    first_post_date,\n    last_post_date,\n    (last_post_date - first_post_date) AS days_active,\n    \n    -- Volume metrics\n    total_posts,\n    total_posts_with_images,\n    ROUND(\n        total_posts::NUMERIC / NULLIF((last_post_date - first_post_date), 0), \n        2\n    ) AS avg_posts_per_day,\n    \n    -- Engagement metrics\n    ROUND(avg_views::NUMERIC, 2) AS avg_views,\n    ROUND(avg_forwards::NUMERIC, 2) AS avg_forwards,\n    max_views,\n    total_views,\n    total_forwards,\n    ROUND(avg_message_length::NUMERIC, 2) AS avg_message_length,\n    \n    -- Derived metrics\n    ROUND(engagement_rate::NUMERIC * 100, 2) AS engagement_rate_pct,\n    ROUND(image_content_ratio::NUMERIC * 100, 2) AS image_content_pct,\n    \n    -- Metadata\n    CURRENT_TIMESTAMP AS created_at,\n    CURRENT_TIMESTAMP AS updated_at\n\nFROM channel_metrics", "relation_name": "\"medical_warehouse\".\"public_marts\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T08:42:28.192265Z", "completed_at": "2026-01-18T08:42:28.199566Z"}, {"name": "execute", "started_at": "2026-01-18T08:42:28.200513Z", "completed_at": "2026-01-18T08:42:28.350958Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.18108391761779785, "adapter_response": {"_message": "SELECT 1597", "code": "SELECT", "rows_affected": 1597}, "message": "SELECT 1597", "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "/*\n    Dimension: Dates\n    Date dimension table for time-based analysis\n    Generates dates from the earliest message to today + 1 year\n*/\n\nWITH date_spine AS (\n    -- Get min and max dates from messages\n    SELECT\n        MIN(message_date)::DATE AS min_date,\n        CURRENT_DATE + INTERVAL '1 year' AS max_date\n    FROM \"medical_warehouse\".\"public_staging\".\"stg_telegram_messages\"\n),\n\ndate_range AS (\n    SELECT\n        generate_series(\n            (SELECT min_date FROM date_spine),\n            (SELECT max_date FROM date_spine),\n            '1 day'::INTERVAL\n        )::DATE AS full_date\n)\n\nSELECT\n    -- Surrogate key (YYYYMMDD format)\n    TO_CHAR(full_date, 'YYYYMMDD')::INTEGER AS date_key,\n    \n    -- Full date\n    full_date,\n    \n    -- Day attributes\n    EXTRACT(DAY FROM full_date)::INTEGER AS day_of_month,\n    EXTRACT(DOW FROM full_date)::INTEGER AS day_of_week,  -- 0=Sunday, 6=Saturday\n    EXTRACT(DOY FROM full_date)::INTEGER AS day_of_year,\n    TO_CHAR(full_date, 'Day') AS day_name,\n    TO_CHAR(full_date, 'Dy') AS day_name_short,\n    \n    -- Week attributes\n    EXTRACT(WEEK FROM full_date)::INTEGER AS week_of_year,\n    TO_CHAR(full_date, 'IYYY-IW') AS year_week,\n    DATE_TRUNC('week', full_date)::DATE AS week_start_date,\n    \n    -- Month attributes\n    EXTRACT(MONTH FROM full_date)::INTEGER AS month,\n    TO_CHAR(full_date, 'Month') AS month_name,\n    TO_CHAR(full_date, 'Mon') AS month_name_short,\n    TO_CHAR(full_date, 'YYYY-MM') AS year_month,\n    DATE_TRUNC('month', full_date)::DATE AS month_start_date,\n    \n    -- Quarter attributes\n    EXTRACT(QUARTER FROM full_date)::INTEGER AS quarter,\n    'Q' || EXTRACT(QUARTER FROM full_date)::TEXT AS quarter_name,\n    TO_CHAR(full_date, 'YYYY-\"Q\"Q') AS year_quarter,\n    DATE_TRUNC('quarter', full_date)::DATE AS quarter_start_date,\n    \n    -- Year attributes\n    EXTRACT(YEAR FROM full_date)::INTEGER AS year,\n    \n    -- Flags\n    CASE \n        WHEN EXTRACT(DOW FROM full_date) IN (0, 6) THEN TRUE\n        ELSE FALSE\n    END AS is_weekend,\n    \n    CASE \n        WHEN EXTRACT(DOW FROM full_date) NOT IN (0, 6) THEN TRUE\n        ELSE FALSE\n    END AS is_weekday,\n    \n    -- Ethiopian calendar helper (approximate)\n    CASE\n        WHEN EXTRACT(MONTH FROM full_date) = 9 AND EXTRACT(DAY FROM full_date) >= 11 THEN 'New Year'\n        WHEN EXTRACT(MONTH FROM full_date) = 9 AND EXTRACT(DAY FROM full_date) = 27 THEN 'Meskel'\n        WHEN EXTRACT(MONTH FROM full_date) = 1 AND EXTRACT(DAY FROM full_date) = 7 THEN 'Genna'\n        WHEN EXTRACT(MONTH FROM full_date) = 1 AND EXTRACT(DAY FROM full_date) = 19 THEN 'Timkat'\n        ELSE NULL\n    END AS ethiopian_holiday,\n    \n    -- Relative date attributes\n    CASE\n        WHEN full_date = CURRENT_DATE THEN TRUE\n        ELSE FALSE\n    END AS is_today,\n    \n    CASE\n        WHEN full_date = CURRENT_DATE - 1 THEN TRUE\n        ELSE FALSE\n    END AS is_yesterday,\n    \n    CASE\n        WHEN full_date >= DATE_TRUNC('week', CURRENT_DATE)\n        AND full_date < DATE_TRUNC('week', CURRENT_DATE) + INTERVAL '1 week'\n        THEN TRUE\n        ELSE FALSE\n    END AS is_current_week,\n    \n    CASE\n        WHEN full_date >= DATE_TRUNC('month', CURRENT_DATE)\n        AND full_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month'\n        THEN TRUE\n        ELSE FALSE\n    END AS is_current_month,\n    \n    CASE\n        WHEN full_date >= DATE_TRUNC('year', CURRENT_DATE)\n        AND full_date < DATE_TRUNC('year', CURRENT_DATE) + INTERVAL '1 year'\n        THEN TRUE\n        ELSE FALSE\n    END AS is_current_year\n\nFROM date_range", "relation_name": "\"medical_warehouse\".\"public_marts\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T08:42:28.359723Z", "completed_at": "2026-01-18T08:42:28.377839Z"}, {"name": "execute", "started_at": "2026-01-18T08:42:28.378866Z", "completed_at": "2026-01-18T08:42:28.482885Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12644100189208984, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "/*\n    Fact Table: Messages\n    One row per message with foreign keys to dimension tables\n*/\n\nWITH messages AS (\n    SELECT * FROM \"medical_warehouse\".\"public_staging\".\"stg_telegram_messages\"\n),\n\nchannels AS (\n    SELECT \n        channel_key,\n        channel_name\n    FROM \"medical_warehouse\".\"public_marts\".\"dim_channels\"\n),\n\ndates AS (\n    SELECT\n        date_key,\n        full_date\n    FROM \"medical_warehouse\".\"public_marts\".\"dim_dates\"\n)\n\nSELECT\n    -- Fact table primary key\n    md5(cast(coalesce(cast(m.message_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(m.channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS message_key,\n    \n    -- Natural key\n    m.message_id,\n    \n    -- Foreign keys to dimensions\n    c.channel_key,\n    d.date_key,\n    \n    -- Degenerate dimensions (attributes that don't warrant their own dimension)\n    m.message_timestamp,\n    m.message_hour,\n    m.day_of_week,\n    \n    -- Message content\n    m.message_text,\n    m.message_length,\n    m.is_empty_message,\n    \n    -- Media attributes\n    m.has_media,\n    m.has_image,\n    m.image_path,\n    \n    -- Engagement metrics (measures/facts)\n    m.view_count,\n    m.forward_count,\n    \n    -- Calculated engagement metrics\n    CASE \n        WHEN m.view_count > 0 THEN m.forward_count::FLOAT / m.view_count\n        ELSE 0\n    END AS forward_rate,\n    \n    -- Reply context\n    m.is_reply,\n    m.reply_to_msg_id,\n    \n    -- Text analysis flags\n    CASE \n        WHEN LOWER(m.message_text) LIKE '%price%' \n          OR LOWER(m.message_text) LIKE '%birr%'\n          OR LOWER(m.message_text) LIKE '%br%'\n          OR m.message_text ~ '\\d+\\s*(birr|br|etb)' THEN TRUE\n        ELSE FALSE\n    END AS mentions_price,\n    \n    CASE\n        WHEN LOWER(m.message_text) LIKE '%available%'\n          OR LOWER(m.message_text) LIKE '%in stock%'\n          OR LOWER(m.message_text) LIKE '%\u1208\u123d\u12eb\u132d%' THEN TRUE\n        ELSE FALSE\n    END AS mentions_availability,\n    \n    CASE\n        WHEN LOWER(m.message_text) LIKE '%delivery%'\n          OR LOWER(m.message_text) LIKE '%shipping%'\n          OR LOWER(m.message_text) LIKE '%\u12a0\u12f5\u122b\u123b%' THEN TRUE\n        ELSE FALSE\n    END AS mentions_delivery,\n    \n    -- Content categorization\n    CASE\n        WHEN m.message_length = 0 AND m.has_image THEN 'Image Only'\n        WHEN m.message_length > 0 AND m.has_image THEN 'Image with Text'\n        WHEN m.message_length > 0 AND NOT m.has_image THEN 'Text Only'\n        ELSE 'Empty'\n    END AS content_type,\n    \n    -- Engagement category\n    CASE\n        WHEN m.view_count = 0 THEN 'No Views'\n        WHEN m.view_count < 50 THEN 'Low Engagement'\n        WHEN m.view_count < 200 THEN 'Medium Engagement'\n        ELSE 'High Engagement'\n    END AS engagement_category,\n    \n    -- Metadata\n    m.source_file,\n    m.scraped_at,\n    CURRENT_TIMESTAMP AS loaded_at\n\nFROM messages m\nLEFT JOIN channels c ON m.channel_name = c.channel_name\nLEFT JOIN dates d ON m.message_date = d.full_date", "relation_name": "\"medical_warehouse\".\"public\".\"fct_messages\"", "batch_results": null}], "elapsed_time": 0.9572327136993408, "args": {"log_path": "C:\\Users\\reus\\Desktop\\Tenx\\medical-telegram-warehouse\\logs", "favor_state": false, "project_dir": "C:\\Users\\reus\\Desktop\\Tenx\\medical-telegram-warehouse", "print": true, "require_unique_project_resource_names": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_format": "default", "which": "run", "partial_parse": true, "require_generic_test_arguments_property": true, "introspect": true, "use_fast_test_edges": false, "empty": false, "populate_cache": true, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": true, "strict_mode": false, "invocation_command": "dbt run", "select": [], "macro_debugging": false, "exclude": [], "show_resource_report": false, "cache_selected_only": false, "use_colors": true, "require_nested_cumulative_type_params": false, "vars": {}, "log_level_file": "debug", "defer": false, "require_all_warnings_handled_by_warn_error": false, "log_level": "info", "version_check": true, "validate_macro_args": false, "send_anonymous_usage_stats": true, "upload_to_artifacts_ingest_api": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "require_ref_searches_node_package_before_root": false, "skip_nodes_if_on_run_start_fails": false, "printer_width": 80, "source_freshness_run_project_hooks": true, "log_format_file": "debug", "use_colors_file": true, "write_json": true, "profiles_dir": "C:\\Users\\reus\\.dbt", "static_parser": true, "show_all_deprecations": false, "state_modified_compare_more_unrendered_values": false, "require_batched_execution_for_custom_microbatch_strategy": false}}